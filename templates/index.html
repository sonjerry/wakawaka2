<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>WAKAWAKA</title>

  <link rel="preload" href="/static/style.css" as="style">
  <link rel="stylesheet" href="/static/style.css">

  <link rel="preload" href="/static/app.js" as="script">
</head>
<body class="cluster-off">
  <noscript>
    <div class="noscript-warning">
      이 페이지는 JavaScript가 필요합니다. 브라우저에서 JavaScript를 활성화하세요.
    </div>
  </noscript>

  <div class="toast" id="toast"></div>

  <header class="topbar" role="banner">
    <div class="topbar-left">WAKAWAKA</div>
    <div class="topbar-right">
      <div class="status-pill off" id="statusPill">OFF</div>
    </div>
  </header>

  <div class="video-container">
    <img id="videoStream" class="video-stream" src="http://100.84.162.124:8889/cam" alt="Camera stream" />
    <iframe id="videoFallback" class="video-fallback-iframe" src="http://100.84.162.124:8889/cam" allow="autoplay; fullscreen; picture-in-picture" title="Camera fallback"></iframe>
  </div>

  <div class="main-layout">
    <div class="bottom-left-controls">
      <button class="engine-btn engine-round" id="btnEngine" aria-pressed="false">시동</button>
      <button class="control-btn" id="btnHead" aria-pressed="false">전조등</button>
      <button class="control-btn" id="btnSport" aria-pressed="false">스포츠</button>
    </div>

    <div class="instrument-cluster">
      <div class="center-info">
        <div class="gear-display" id="gearIndicator" aria-live="polite">P</div>
        <div class="net-card">
          <div class="net-label">NET</div>
          <div class="net-value" id="netLatency">— ms</div>
        </div>
        <div class="shift-info" id="shiftInfo" style="display: none;">
          <div class="shift-state" id="shiftState">READY</div>
          <div class="torque-cmd" id="torqueCmd">0%</div>
        </div>
      </div>

      <div class="speed-display" aria-label="속도 표시">
        <div class="tesla-speed">
          <div class="speed-value" id="speedValue">0</div>
          <div class="speed-unit">km/h</div>
        </div>
      </div>
      
      <div class="car-visual" aria-label="차량 상태">
        <svg class="car-svg" viewBox="0 0 160 260" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
          <defs>
            <linearGradient id="beamGrad" x1="0" y1="1" x2="0" y2="0">
              <stop offset="0%" stop-color="rgba(255,255,200,0.0)"/>
              <stop offset="60%" stop-color="rgba(255,255,200,0.25)"/>
              <stop offset="100%" stop-color="rgba(255,255,200,0.7)"/>
            </linearGradient>
            <filter id="beamBlur" x="-30%" y="-30%" width="160%" height="160%">
              <feGaussianBlur in="SourceGraphic" stdDeviation="6"/>
            </filter>
            <radialGradient id="glowGrad" cx="50%" cy="50%" r="50%">
              <stop offset="0%" stop-color="rgba(255,255,230,0.9)"/>
              <stop offset="100%" stop-color="rgba(255,255,230,0)"/>
            </radialGradient>
          </defs>

          <!-- 차체 (세로 배치, 위쪽이 전면) -->
          <rect x="30" y="40" width="100" height="180" rx="16" class="car-body" />

          <!-- 앞바퀴 (조향 회전) : 위쪽 -->
          <rect id="carWheelFL" x="24" y="46" width="28" height="10" rx="3" class="wheel front" />
          <rect id="carWheelFR" x="108" y="46" width="28" height="10" rx="3" class="wheel front" />

          <!-- 뒷바퀴 (고정) : 아래쪽 -->
          <rect x="24" y="204" width="28" height="10" rx="3" class="wheel rear" />
          <rect x="108" y="204" width="28" height="10" rx="3" class="wheel rear" />

          <!-- 헤드라이트 렌즈 글로우 -->
          <circle cx="46" cy="40" r="8" fill="url(#glowGrad)" class="lens-glow" />
          <circle cx="114" cy="40" r="8" fill="url(#glowGrad)" class="lens-glow" />

          <!-- 헤드라이트 빔 (상단 방향, 고품질 그라디언트+블러) -->
          <g class="headlight-group">
            <polygon class="beam" points="32,40 14,4 68,4 58,40" fill="url(#beamGrad)" filter="url(#beamBlur)" />
            <polygon class="beam" points="128,40 102,4 146,4 148,40" fill="url(#beamGrad)" filter="url(#beamBlur)" />
          </g>
        </svg>
      </div>
    </div>

    <div class="bottom-right-controls">
      <div class="gear-input-container">
        <div class="card gear-selector" role="group" aria-label="기어 선택">
          <button class="gear-btn" data-gear="P" aria-label="P 기어">P</button>
          <button class="gear-btn" data-gear="R" aria-label="R 기어">R</button>
          <button class="gear-btn" data-gear="N" aria-label="N 기어">N</button>
          <button class="gear-btn" data-gear="D" aria-label="D 기어">D</button>
        </div>
        
        <div class="card axis-card" aria-label="입력축 표시">
          <div class="axis-title">INPUT</div>
          <div class="axis-bar" aria-hidden="true">
            <div class="axis-fill-pos" id="axisBarFill"></div>
            <div class="axis-fill-neg" id="axisBarFillNeg"></div>
            <div class="axis-center-line"></div>
          </div>
          <div class="axis-readout" id="axisReadout">0</div>
        </div>

        <div class="card debug-card" aria-label="디버그 표시">
          <div class="debug-row"><span>Steer:</span> <span id="dbgSteer">0°</span></div>
          <div class="debug-row"><span>Throttle:</span> <span id="dbgThrottle">120°</span></div>
        </div>
      </div>
    </div>
  </div>

  <script src="/static/app.js" defer></script>
</body>
</html>